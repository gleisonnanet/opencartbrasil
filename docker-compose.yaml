version: '3.7'

volumes:
    ocbr_database:

networks:
    ocbr_network:

services:
    ocbr:
        env_file:
            - .env
        container_name: opencartbrasil
        build:
          context: .docker
          dockerfile: Dockerfile
          args:
            VERSION: "1.x"
        ports:
            - 81:80
        environment:
            - DB_HOSTNAME=ocbr_db
            - DB_USERNAME=store
            - DB_PASSWORD=store
            - DB_DATABASE=opencartbrasil
            - USERNAME=admin
            - PASSWORD=admin
            - HTTP_SERVER=http://localhost:81/
        networks:
            - ocbr_network
        volumes:
            - ./:/var/www/html
        depends_on:
            - ocbr_db

    ocbr_db:
        env_file:
            - .env
        image: mysql:5.7
        container_name: opencartbrasil_db
        environment:
            - MYSQL_RANDOM_ROOT_PASSWORD=yes
            - MYSQL_ROOT_PASSWORD=root
            - MYSQL_USER=store
            - MYSQL_PASSWORD=store
            - MYSQL_DATABASE=opencartbrasil
            - MYSQL_TCP_PORT=3307
        ports:
            - 3307:3307
        expose:
            - 3307
        networks:
            - ocbr_network
        volumes:
            - ocbr_database:/var/lib/mysql